<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Laberinto Lunar 15x15</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <style>
    #laberintoContainer {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 30px;
      touch-action: none;
    }
    #laberinto {
      display: grid;
      grid-template-columns: repeat(15, 30px);
      grid-template-rows: repeat(15, 30px);
      gap: 1px;
      transition: transform 2s;
    }
    .celda {
      width: 30px;
      height: 30px;
      background-color: #ddd;
    }
    .pared {
      background-color: #333;
    }
    .nave {
      background-color: blue;
    }
    .meta {
      background-color: gold;
    }
    .touch-controls {
      position: fixed;
      bottom: 20px;
      width: 100%;
      display: none;
      justify-content: center;
      gap: 10px;
    }
    .touch-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      font-size: 24px;
      background-color: rgba(0, 123, 255, 0.8);
      border: none;
      color: white;
      touch-action: manipulation;
    }
    @media (hover: none) {
      .touch-controls {
        display: flex;
      }
    }
  </style>
</head>
<body class="bg-light">
  <div class="container text-center">
    <h2>üõ∏ Laberinto Lunar 15x15</h2>
    <p>¬°Llega a la luna antes de que el laberinto gire!</p>
    <div id="laberintoContainer">
      <div id="laberinto"></div>
    </div>

    <!-- Controles t√°ctiles -->
    <div class="touch-controls">
      <div class="d-flex flex-column align-items-center gap-2">
        <button class="touch-btn" id="btnUp">‚Üë</button>
        <div class="d-flex gap-2">
          <button class="touch-btn" id="btnLeft">‚Üê</button>
          <button class="touch-btn" id="btnRight">‚Üí</button>
        </div>
        <button class="touch-btn" id="btnDown">‚Üì</button>
      </div>
    </div>

    <form id="form" method="POST" style="display: none;">
      <input type="hidden" name="tiempo" id="tiempo">
      <button class="btn btn-success mt-3" type="submit">¬°Continuar!</button>
    </form>
  </div>

  <script>
    const mapa = [
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [1,1,1,1,0,1,1,1,1,1,0,1,1,1,0],
      [0,0,0,1,0,1,0,0,0,1,0,0,0,1,0],
      [0,1,0,1,1,1,0,1,1,1,0,1,0,1,0],
      [0,1,0,0,0,0,0,1,0,0,0,1,0,1,0],
      [0,1,1,1,1,1,1,1,0,1,1,1,0,1,0],
      [0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],
      [0,1,1,1,1,1,1,1,1,1,1,1,0,1,0],
      [0,1,0,0,0,1,1,0,0,0,1,1,0,1,0],
      [0,1,1,1,0,1,1,1,1,1,0,1,1,1,0],
      [0,0,0,1,0,0,1,0,0,1,0,0,0,0,0],
      [0,1,1,1,1,1,1,1,0,1,1,1,1,1,0],
      [0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],
      [0,1,1,1,1,1,0,1,1,1,1,1,0,1,0],
      [0,0,0,0,0,1,1,1,0,0,0,1,1,1,2]
    ];
    
    let posX = 0, posY = 0;
    const laberinto = document.getElementById('laberinto');
    let startTime = Date.now();
    let currentRotation = 0;
    let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

    function mover(dx, dy) {
      const nuevoX = posX + dx;
      const nuevoY = posY + dy;
      
      if (
        nuevoX >= 0 && nuevoY >= 0 &&
        nuevoY < mapa.length && nuevoX < mapa[0].length &&
        mapa[nuevoY][nuevoX] !== 0
      ) {
        posX = nuevoX;
        posY = nuevoY;
        dibujarLaberinto();
        
        if (mapa[posY][posX] === 2) {
          const tiempo = ((Date.now() - startTime) / 1000).toFixed(1);
          document.getElementById('tiempo').value = tiempo;
          document.getElementById('form').style.display = 'block';
        }
      }
    }

    function dibujarLaberinto() {
      laberinto.innerHTML = '';
      for (let y = 0; y < mapa.length; y++) {
        for (let x = 0; x < mapa[y].length; x++) {
          const celda = document.createElement('div');
          celda.classList.add('celda');
          if (mapa[y][x] === 0) celda.classList.add('pared');
          if (mapa[y][x] === 2) celda.classList.add('meta');
          if (x === posX && y === posY) celda.classList.add('nave');
          laberinto.appendChild(celda);
        }
      }
    }

    // Controles de teclado
    document.addEventListener('keydown', (e) => {
      switch(e.key) {
        case 'ArrowUp': mover(0, -1); break;
        case 'ArrowDown': mover(0, 1); break;
        case 'ArrowLeft': mover(-1, 0); break;
        case 'ArrowRight': mover(1, 0); break;
      }
    });

    // Controles t√°ctiles
    if (isMobile) {
      document.getElementById('btnUp').addEventListener('touchstart', (e) => {
        e.preventDefault();
        mover(0, -1);
      });
      
      document.getElementById('btnDown').addEventListener('touchstart', (e) => {
        e.preventDefault();
        mover(0, 1);
      });
      
      document.getElementById('btnLeft').addEventListener('touchstart', (e) => {
        e.preventDefault();
        mover(-1, 0);
      });
      
      document.getElementById('btnRight').addEventListener('touchstart', (e) => {
        e.preventDefault();
        mover(1, 0);
      });
    }

    // Rotaci√≥n autom√°tica del laberinto
    setInterval(() => {
      currentRotation = (currentRotation + 90) % 360;
      laberinto.style.transform = `rotate(${currentRotation}deg)`;
    }, 5000);

    dibujarLaberinto();
  </script>
</body>
</html>
